<!DOCTYPE html><html lang="pt-BR" data-info="2023-05-22 15:53:46" prefix="og: https://ogp.me/ns#"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/3d4c49d454f5110f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3d4c49d454f5110f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-d5c25fd331c4dadd.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-d1c8bf56a477bf12.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f2a8039f2a281cd9.js" defer=""></script><script src="/_next/static/chunks/793-f7eccf4efa0853f4.js" defer=""></script><script src="/_next/static/chunks/431-411c5de10608364a.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-aeba815c9d0f9c8a.js" defer=""></script><script src="/_next/static/ELQRcx_154LTzIlOxF1pg/_buildManifest.js" defer=""></script><script src="/_next/static/ELQRcx_154LTzIlOxF1pg/_ssgManifest.js" defer=""></script></head><body><div id="__next"></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Integrando Notion com Github","category":[],"date":"2023-05-22 15:37","cover_image":"https://umdevqualquer.com.br/images/integrando-notion-com-github/Frame_1_XghZLEg0.png","cover_image_alt":"Imagem com a logo da notion + logo github actions","cover_image_link":null,"cover_image_by":null,"series":[],"summary":"\nFala pessoa, como c√™ t√°?\n\nSim, o blog n√£o morreu üòÇ, eu s√≥ n√£o tenho conseguido escrever nada. Por mais que meus posts sejam como especial ...","slug":"integrando-notion-com-github","content":"Fala pessoa, como c√™ t√°?\n\nSim, o blog n√£o morreu üòÇ, eu s√≥ n√£o tenho conseguido escrever nada. Por mais que meus posts sejam como especial de natal, que s√≥ aparece uma vez por ano e n√£o necessariamente √© t√£o bom ü§£ü§£.\n\nEu tenho estado muito ocupado e acabo n√£o conseguido parar pra escrever, principalmente pela forma que eu preciso pra escrever. Meu blog √© feito com NextJS e hospedado via Github pages e por isso, eu preciso ou estar no meu pc + escrever + realizar o build e postar ou baixar o projeto + instalar depend√™ncias + escrever + realizar o build e ent√£o postar. O que aumenta o ‚Äúcusto‚Äù na hora de escrever (*Resumindo, da pregui√ßa!*).\n\n\u003c!-- START_SUMMARY -‚Üí\n\nMas como o titulo do post da o spoiler, eu descobri uma forma de facilitar a minha cria√ß√£o de post utilizando o poder do Notion, sem tirar a liberdade que eu possuo em ter o meu blog feito por mim e hospedado no Github pages.\n\n\u003c!-- END_SUMMARY -‚Üí\n\nEu tenho trabalhado muito voltado ao DX ( e esse assunto j√° est√° na lista de posts pra escrever ) mas eu mesmo n√£o fa√ßo isso pra mim ( o cl√°ssico ‚Äú_em casa de ferreiro, o espeto √© de pau_‚Äù ).\n\n## Conhecendo as ferramentas\n\n- [**Notion**](https://notion.so)\n\n\tOnde eu pretendo escrever e gerenciar os posts do meu blog.\n\n\t_Se voc√™ n√£o conhece o_ [_Notion_](https://notion.so) _eu recomendo, √© uma grande ferramenta que ajuda em v√°rios pontos da minha vida._\n\n- [**Github**](https://github.com) (Pages e Actions)\n\n\tHoje eu j√° hospedo o meu blog via Github Pages, visto que o blog √© est√°tico e finalmente vou utilizar o Github Actions para fazer o build e o deploy do blog.\n\n- [**Next JS**](https://nextjs.org/)\n\n\tPara gerar os est√°ticos eu fiz o meu blog inteiro utilizando o Next.\n\n## Come√ßando pelo o come√ßo\n\nEu, a um tempo, estava incomodado de n√£o ter criado uma pipeline pra fazer os testes e o build/deploy do meu blog, mas mais incomodado ainda em n√£o estar postando com frequ√™ncia, principalmente porque hoje para mim √© cansativo escrever um post.\n\nHoje estou mais acostumado com o Gitlab CI, visto que na Globo usamos o Gitlab. Eu j√° conhecia o Github Actions, mas nunca havia mexido. Ent√£o acabava postergando o aprendizado e a utiliza√ß√£o do Github actions. \n\nEm um dado momento, dado a praticidade de utilizar o Notion, eu acabei me perguntado se n√£o era poss√≠vel integrar ele com o meu Blog, para facilitar o gerenciamento dos posts e assim me incentivar a escrever mais ( ainda mais porque eu to cheio de ideias de post mas sem saco de passar pelo o processo de escrita que possuo hoje ).\n\nCom isso, acabei encontrando uma action para o Github, que faz o a integra√ß√£o com o Notion, por√©m eu tive uma certa dificuldade para configur√°-lo üòû, a documenta√ß√£o dele foi a melhor que eu achei dessas actions, por√©m j√° est√° meio desatualizada e n√£o tem algumas infos importantes, que eu quebrei a cabe√ßa para entender.\n\nChega de hist√≥ria, vamos para a a√ß√£o!\n\n## Notion\n\nPara facilitar a visualiza√ß√£o, vamos come√ßar adaptando o Notion para esperar a integra√ß√£o com o Github, para isso vamos criar uma pagina de database e nela vai ficar listada todos os posts que ser√£o publicados no blog. Ent√£o coloque as propriedade que voc√™ quiser, no meu caso ficou assim: \n\n![Print da tela do database do notion com as colunas: Title, created_at, Status, Category](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/d439790a-fcdc-4311-b2d1-286646825697/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230522T153753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Signature=7e589b87b4523a81b098be8131a1161aec79194b2750a78254fab9b9ab91f36f\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject)\n\n_Os campos podem ser quais voc√™ quiser, porem √©_ _**obrigat√≥rio**_ _possuir o campo ‚Äústatus‚Äù (ou outro que fa√ßa o mesmo trabalho, que voc√™ entender√° mais a frente)._ \n\nCom essa tabela criada, j√° possu√≠mos uma estrutura onde podemos criar todos os nossos post e, de brinde, criar status onde voc√™ pode saber se j√° est√° postado, escrevendo ou √© apenas uma ideia.\n\n### Iniciando a integra√ß√£o\n\n- Agora para preparar o terreno para integra√ß√£o vamos adicionar uma conex√£o, nas op√ß√µes da tabela, v√° at√© gerenciamento de conex√£o (Manage connections)\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/9cae4ff0-b558-4151-9420-31e5b3ef8dba/Screenshot_2023-05-13_at_22.15.11.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230522T153753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Signature=1ca914c6a6114a854b46f0ab8f08dcf90ea3621fffa109f864db7369391a1386\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject)\n\n- Na janela que abrir, procure no fim da tela o campo: _Developer or manager integrations_\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/b7490e14-1225-450c-bec9-994eb3381989/Screenshot_2023-05-13_at_22.15.33.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230522T153753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Signature=a8bec7980579f4a6ac76aa0ed8f5eead1d423909277a3bc2e02593e03a770ae0\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject)\n\n- Ele vai te redirecionar at√© a area de integra√ß√µes de api do Notion\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/f3b965f3-b88f-4e8d-98cc-42ca7418be0c/Screenshot_2023-05-13_at_22.15.56.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230522T153753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Signature=a8d9329c8045cddcd4be75f2b211e32fac763525a2a2724288dd94cbdc267ca7\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject)\n\n- Clique para adicionar uma nova integra√ß√£o ( New Integration ) e preencha o campo de Name com o nome que voce quiser dar, uma imagem para voc√™ saber o que voc√™ est√° associando e qual o workspace do notion essa api vai ser associada.\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/755a0360-1355-49ab-a414-e5fb653b01b4/Screenshot_2023-05-13_at_22.17.13.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230522T153753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Signature=8a7554a2c68de4c8c70b579c3b3a7cccffe5c3dc0ef1de3082dca0bca294fe70\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject)\n\nAp√≥s criado ele ir√° gerar uma **secret key,** guarde ela que iremos utiliza-la mais a frente. (Voc√™ consegue acessar ela a hora que voc√™ quiser, n√£o se preocupe).\n\n- Depois disso, voltamos para a nossa tabela e acessamos a configura√ß√£o dela, e no campo de conex√£o, a gente adiciona a  integra√ß√£o que acabamos de criar.\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/8fea011f-4cf6-4d5d-a718-75598d883452/Screenshot_2023-05-13_at_22.18.47.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230522T153753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Signature=c6112e5f42e0145f4c1201df991a83f6442a2c48fae0d0022018fd0f34f668c7\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject)\n\nPronto! A parte referente ao Notion foi finalizada üòÑ\n\n## Github actions (Gh Actions)\n\nEu n√£o vou mostrar uma config completa e/ou explicar como funciona o Github Actions, at√© porque eu ainda estou aprendendo/ me entendendo com ele. \n\n### Environments\n\nVamos criar logo as nossas vari√°veis de ambiente para ser utilizada na pipeline. \n\n-  V√° at√© as configura√ß√µes do seu projeto e acesse o menu ‚Äú**Environments**‚Äù, \n\nNessa tela voc√™ ter√° duas formas de criar vari√°veis de ambiente, uma secreta e outra aberta.\n\n-  Na parte de cria√ß√£o das vari√°veis secretas, n√≥s vamos criar duas: **NOTION_ROOT_PAGE_ID** e **NOTION_TOKEN**,  onde os valores deles ser√£o a url da database do notion e a **secret key** obtido na explica√ß√£o do Notion, respectivamente.\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/567d71da-3a4a-4b18-bd08-8c43347dca45/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230522T153753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Signature=416c9b19013202915daf47d920878f17e8c036540584e9f72be5cadee42f4783\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject)\n\n-  Na parte da cria√ß√£o das vari√°veis, eu preferi criar 3 vari√°veis, para me dar a liberdade de n√£o ter que ficar mexendo no c√≥digo toda hora que eu precisar alterar alguma info que a action usa para tratar os dados do notion. Essas vari√°veis s√£o: **FILTER_PROP**, **FILTER_VALUES** e  **POST_URI**. Onde:\n\n\t- **FILTER_PROP** fica o nome do campo onde eu quero que o Github filtre para saber qual o post ele ter√° que publicar.\n\n\t- **FILTER_VALUES** fica o valor do campo que, quando um post tiver esse valor no campo de filtro, ser√° o indicativo para o Github para saber que √© o post ele ter√° que publicar.\n\n\t- **POST_URI** √© o nome do campo onde ele vai usar o valor final (como o nome do post, por exemplo) para ajudar a montar o path de arquivos.\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a644c908-9438-4510-b947-d8981a2e5d03/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230522T153753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Signature=71616ceba62458b94b8559021992e59392b4b2ef2e64aaac3f769fa5a5046894\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject)\n\n### Criando seu job / action:\n\nPesquisando, acabei caindo na action [Notion jam](https://github.com/victornpb/notion-jam), que pega os dados e gera um arquivo markdown. Tamb√©m peguei outras actions, o [git auto commit action](https://github.com/stefanzweifel/git-auto-commit-action) e o [GitHub push action](https://github.com/ad-m/github-push-action) para poder fazer um commit e puxar o arquivo criado na branch que eu to usando.\n\nPara facilitar a explica√ß√£o, eu vou colar o meu arquivo de actions aqui \n\n```yaml\nname: Sync Notion pages to posts\n\non:\n  schedule:\n    - cron: '0 13 * * *' # daily\n\n  workflow_dispatch:\n\njobs:\n  get_and_commit_notions_posts:\n    runs-on: ubuntu-latest\n    environment: github-pages\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: notion-jam\n        uses: victornpb/notion-jam@v0.0.13\n        with:\n          NOTION_SECRET: ${{ secrets.NOTION_TOKEN}}\n          NOTION_DATABASE: ${{ secrets.NOTION_ROOT_PAGE_ID }}\n          FILTER_PROP: ${{ vars.FILTER_PROP }}\n          FILTER_VALUES: ${{ vars.FILTER_VALUES }}\n          ARTICLE_PATH: src/posts/${{ vars.POST_URI }}.md\n          ASSETS_PATH: public/images/${{ vars.POST_URI }}/\n          PARALLEL_PAGES: 25\n          PARALLEL_DOWNLOADS_PER_PAGE: 3\n          DOWNLOAD_IMAGE_TIMEOUT: 30\n\n      - name: Save changes\n        uses: stefanzweifel/git-auto-commit-action@v4\n        with:\n          commit_message: 'docs: add new post'\n      - uses: ad-m/github-push-action@master\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }}\n          branch: ${{ github.ref }}\n```\n\n[Link para o action atualizado](https://github.com/paulopotter/paulopotter.github.io/blob/nextjs/.github/workflows/notion.yml)\n\n## Bonus track\n\nPara facilitar ainda mais a minha vida, eu consegui criar um template na hora de criar um post, dentro do notion, onde ele j√° preenche alguns campos para mim. Al√©m de criar bot√µes de cria√ß√£o r√°pida de post, onde ele j√° preenche alguns dados de acordo com o conte√∫do do bot√£o.\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/d16fe037-70ef-46ed-b684-c8fc02d3e6df/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230522T153753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Signature=298de5afe9773267115ffa8fcb312caa87a30b780b0a24015724973a9ec4475b\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject)\n\n## Thats all folks\n\nEu ainda estou descobrindo o que eu posso fazer no Notion e isso refletir no meu Blog, ainda n√£o sei se todas as funcionalidades que eu tenho no blog eu consigo criar via o Notion. Talvez, posts mais complexos ainda precisem ser manuais.\n\nAinda tenho como meta, conseguir ver uma forma de publicar nas redes sociais automaticamente, talvez at√© via Github actions tamb√©m, mais infelizmente n√£o vai ser dessa vez.\n\n√â isso, espero que esse post te ajude em algo üòÉ.\n\nE com muito orgulho, esse √© o primeiro post que eu fiz a partir dessa integra√ß√£o! Espero que a partir de agora eu consiga manter o blog mais atualizado, gra√ßas a essa facilidade.\n\nValeu, Falow, at√© a pr√≥xima!\n","readingTime":"1 min","related":{"prevPost":{"title":"Utilizando ARIA no seu projeto - Tooltip","date":"2022-07-17","slug":"utilizando-aria-no-seu-projeto-tooltip"}}}},"__N_SSG":true},"page":"/[slug]","query":{"slug":"integrando-notion-com-github"},"buildId":"ELQRcx_154LTzIlOxF1pg","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body><link href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,400;1,700&amp;family=Montserrat:wght@400;700&amp;display=swap" rel="stylesheet"/></html></body></html>